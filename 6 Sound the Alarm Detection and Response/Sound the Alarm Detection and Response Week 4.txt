Sound the Alarm Detection and Response Week 4

	Read and analyze logs
	Interpres signatures
	Search in Siem tools
	
Overview of Logs
	
	The importance of logs
		Date
		Time
		Location
		Action
		Names
		
		Log Types
			Network Logs
				Network logs are generated by network devices like firewalls, routers, or switches.
			System Logs
				System logs are generated by operating systems like Chrome OS™, Windows, Linux, or macOS®. 
			Application Logs
				Application logs are generated by software applications and contain information relating to the events occurring within the application such as a smartphone app.
			Security Logs
				Security logs are generated by various devices or systems such as antivirus software and intrusion detection systems. Security logs contain security-related information such as file deletion.
			Authentication Logs
				Authentication logs are generated whenever authentication occurs such as a successful login attempt into a computer.
				
		Log management
			is the process of collecting, storing, analyzing, and disposing of log data. 
			
		Log protection
			Along with management and retention, the protection of logs is vital in maintaining log integrity. 
			It’s not unusual for malicious actors to modify logs in attempts to mislead security teams and to even hide their activity.
			Storing logs in a centralized log server is a way to maintain log integrity.
			This makes it more difficult for attackers to access logs because there is a barrier between the attacker and the log location. 
		
		
	Variations of Logs
		Timestamps
		System characteristics
		Action
		
		Commonly used log formats
			syslog
				header followed by structured data and message
				
				Protocol:
					The syslog protocol is used to transport logs to a centralized log server for log management.
					It uses port 514 for plaintext logs and port 6514 for encrypted logs.
					
				Service:
					The syslog service acts as a log forwarding service that consolidates logs from multiple sources into a single location.
					The service works by receiving and then forwarding any syslog log entries to a remote server. 
					
				Log format:
					The syslog log format is one of the most commonly used log formats that you will be focusing on.
					It is the native logging format used in  Unix® systems.
					It consists of three components: a header, structured-data, and a message.
				
				Priority (PRI)
					Generally, the lower the priority level, the more urgent the event is. 
				
			JSON
				key value pairs
				
			XML
				tags 
				elements 
				attributes
				
			CSV
				commas to separate values
		
			Common Event Format (CEF)
				is a log format that uses key-value pairs to structure data and identify fields and their corresponding values.
				The CEF syntax is defined as containing the following fields: 
					CEF:Version|Device Vendor|Device Product|Device Version|Signature ID|Name|Severity|Extension 
	
Overview of Intrusion Detection Systems
	
	Security monitoring with detection tools
		
		telemetry
			the collection and transmission of data for analysis
	
		endpoint
			any device connected on a network
			entrypoints on a network
		
		host-based intrustion detection system
			application that monitors the activity of the host on which its installed
			
		network-based intrustion detection system
			an application that ollects and monitors network traffic and network data
				similar to packet sniffers
		
		signature analysis
			a detection method used to find events of interest
				Advantages
					Low rate of false positives:
				Disadvantages
					Signatures can be evaded
					Signatures require updates
					Inability to detect unknown threats
		
		anomoly based analysis
			There are two phases to anomaly-based analysis: a training phase and a detection phase.
				Advantages
					Ability to detect new and evolving threats
				Disadvantages
					High rate of false positives
					Pre-existing compromise
					
					
	Components of a detection signature
		NIDS
			action
				determines the action to take if the rule criteria is met
					alert, pass, reject
			header
				source and destination IP address
				source and destination ports
				protocols
				traffic direction
			rule options
				
	
	Examinging signatures with suricata
		cd /etc/suricata
			configuration files for suricata
		rules
			prewritten signatures
		
		
	Examine Suricata Logs
		EVE JSON:
			extensible event format JSON
		fast.log:
			The fast.log file is used to record minimal alert information including basic IP address and port details about the network traffic. 
			
		The main difference between the eve.json file and the fast.log file is the level of detail that is recorded in each.
		The fast.log file records basic information, whereas the eve.json file contains additional verbose information. 
		
		Types of logs
			Alert Logs
			Network Telemetry Logs
			
	Overview of Suricata
		is an open-source intrusion detection system, intrusion prevention system, and network analysis tool.
		The terms rule and signature are often used interchangeably in Suricata. Security analysts use signatures,
			or patterns associated with malicious activity, to detect and alert on specific malicious activity
		Suricata's configuration file is suricata.yaml, which uses the YAML file format for syntax and structure.
		
		
		Can be used as
			Intrusion detection system (IDS)
			Intrusion prevention system (IPS)
			Network security monitoring (NSM)
		
		jq . /var/log/suricata/eve.json | less
			prints json in a nice format
			
		jq "select(.flow_id==X)" /var/log/suricata/eve.json
		
		
Overview of security information event management
	Reexamine SIEM tools
		Splunk
		Chronicle
			google cloud siem
			search analysis visualization
		
		
	Query for events with Splunk
		Search Processing Language (SPL)
			
			
	Query for events with Chronicle
		YARA-L
			compouter language used for searching through log data
			
		Types of search:
			UDM
				unified data model
				normalized data
			Raw log search
				not been normalized
			
		